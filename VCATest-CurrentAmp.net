* C:\Users\44780\Documents\GitHub\EEE-Summer-Project-2020\VCATest-CurrentAmp.asc
XU1 0 N006 +V -V N007 LT1366
R1 N007 N006 22k
R2 N006 N012 100
R3 N012 N004 1k
J1 N012 N016 0 J113
R4 N016 0 1Meg
V1 +V 0 40
V2 0 -V 40
XX1 CSig1 Trig1 N018 NC_01 NC_02 NC_03 envelope2
V3 Trig1 0 PULSE(0 3 50m 1p 1p 5 6 2)
V5 CSig1 0 SINE(0 5 440)
XU2 N011 N004 +V -V N004 LT1366
R5 N009 0 8
Q1 N008 N010 N009 0 2N2222
XU4 N007 N005 +V -V N005 LT1366
V6 N008 0 30
XU5 NC_04 N020 +V -V N021 LT1366
C1 N021 N020 100p
R6 P001 N021 10
R7 N022 N020 1k
Q2 N019 P001 N022 0 2N2222
V7 N019 0 6
XU3 N005 N009 +V -V N010 LT1366
V4 N011 0 SINE(0 5 440)
XU6 N018 N016 +V -V N016 LT1366
Q3 N002 N001 N003 0 2N2222
Q4 N017 N015 N013 0 2N2907
V8 N002 0 15
V9 N017 0 -15
Q5 N015 N015 N014 0 2N2907
Q6 N001 N001 N014 0 2N2222
Q7 N001 N003 VOut 0 2N2222
R8 N003 VOut 1.5
R9 VOut N013 1.5
Q8 N015 N013 VOut 0 2N2907
R10 N002 N001 10k
R11 N017 N015 10k

* block symbol definitions
.subckt envelope2 carrier_signal trigger OUTPUT OUTPUT_shape+ OUTPUT_shape- Vout_timer
V1 V- 0 -5
V2 V+ 0 5
R1 N007 vout_timer 4.7k
R2 V+ N007 10k
C1 N008 0 1µ V=4 Irms=3.87298 Rser=0.015 Lser=0 mfg="KEMET" pn="A700X227M004ATE015" type="Al electrolytic"
R3 N002 N001 100
RvarD1 N008 N002 0.5Meg
R4 N018 N017 100
RvarR1 N008 N018 0.5Meg
RvarA1 N008 N022 0.5Meg
R5 N022 N021 100
C2 V+ 0 0.1µ
Rset1 N011 0 500k
Ra1 V+ N012 1Meg
Rb1 N012 0 681k
D1 vout_timer N021 1N914
D2 N017 N020 1N914
D3 N001 N004 1N914
XU1 N008 N003 V+ V- N003 LT1366
XU2 N008 OUTPUT_shape+ V+ V- OUTPUT_shape+ LT1366
XU3 0 N005 V+ V- OUTPUT_shape- LT1366
R6 OUTPUT_shape- N005 1k
R7 N005 N003 1k
XU4 trigger 0 N011 N012 V+ vout_timer LTC6993-2
XU6 vout_timer N001 V+ V- N004 LT1366
XU7 vout_timer2 N017 V+ V- N020 LT1366
V3 V-- 0 -15
V4 V++ 0 15
C5 V+ 0 0.1µ
Rset2 N023 0 220k
Ra2 V+ N024 1Meg
Rb2 N024 0 681k
XU8 trigger 0 N023 N024 V+ vout_timer2 LTC6993-2
R8 N010 OUTPUT_shape+ 3k
R9 0 N019 100k
R10 N014 carrier_signal 1k
XU5 N019 N013 V+ V- N013 LT1366
XU9 0 N015 V+ V- N016 LT1366
R11 N016 N015 1k
R12 N015 N013 1k
R13 N006 OUTPUT_shape+ 1k
R14 0 OUTPUT 100k
R15 N009 N016 1k
M1 N014 N010 N019 N019 NMOS
M2 N009 N006 OUTPUT OUTPUT NMOS
.ends envelope2

.model D D
.lib C:\Users\44780\Documents\LTspiceXVII\lib\cmp\standard.dio
.model NPN NPN
.model PNP PNP
.lib C:\Users\44780\Documents\LTspiceXVII\lib\cmp\standard.bjt
.model NJF NJF
.model PJF PJF
.lib C:\Users\44780\Documents\LTspiceXVII\lib\cmp\standard.jft
.model NMOS NMOS
.model PMOS PMOS
.lib C:\Users\44780\Documents\LTspiceXVII\lib\cmp\standard.mos
.tran 5 uic
.lib LTC.lib
.lib LTC6993-2.sub
.backanno
.end
